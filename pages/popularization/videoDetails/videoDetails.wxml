<!--pages/popularization/videoDetails/videoDetails.wxml-->

<wxs src="/utils/utils.wxs" module="tools"></wxs>
<view class="container-video" bindtap="changePlayStatus">
    <!-- <view class='content' wx:if="{{videos.length!=0}}"> -->
    <view class="animation-wrapper" animation="{{animation}}">
        <block wx:for="{{videos}}" wx:key="{{item.poster}}">
            <view class="animation-image-wrapper">
                <image class="animation-image" src="{{item.poster}}"></image>
            </view>
        </block>
    </view>

    <!-- <video class="video" 
            bindtimeupdate="bindtimeupdate" 
            id="kdvideo" 
            bindtouchstart="touchStart" 
    -->
    <video class="video" 
        id="kdvideo" 
        bindtouchstart="touchStart"
        bindtouchend="touchEnd" 
        bindtouchcancel="touchCancel" 
        binderror="binderror" 
        autoplay="{{autoplay}}"
        objectFit="cover" 
        hidden="{{animationShow}}" 
        src="{{videos[videoIndex].videoUrl}}" 
        bindplay="bindplay"
        controls="{{controls}}" 
        loop="true">

        <!-- 页面的工具栏 -->
        <cover-view class="tools">
            <!-- 用户头像 -->
            <cover-view class='user-image'>
                <!-- 默认头像 -->
                <cover-image class="userinfo-avatar" 
                    wx:if="{{!videos[videoIndex].icon && !userData.headPic}}"
                    data-lecturerId="{{videos[videoIndex].lecturerId}}" 
                    catchtap='goUserHome'
                    src="/images/be/8.jpeg">
                </cover-image>
                <cover-image class="userinfo-avatar" 
                    wx:elif="{{!videos[videoIndex].icon}}"
                    data-lecturerId="{{videos[videoIndex].lecturerId}}" 
                    catchtap='goUserHome'
                    src="{{userData.headPic}}">
                </cover-image>
                <cover-image class="userinfo-avatar" 
                    wx:else data-lecturerId="{{videos[videoIndex].lecturerId}}"
                    catchtap='goUserHome' 
                    src="{{videos[videoIndex].icon}}">
                </cover-image>
                <!-- 未关注 -->
                <cover-image class="userinfo-add" 
                    wx:if="{{videos[videoIndex].isfans == 0}}" 
                    src="/images/video/add.png"
                    data-index="{{videoIndex}}" 
                    data-lecturerId="{{videos[videoIndex].lecturerId}}"
                    catchtap='addLecturerFans'>
                </cover-image>
                <!-- 关注 -->
                <cover-image class="userinfo-add" 
                    wx:else src="/images/video/guanzhu.png" 
                    data-index="{{videoIndex}}"
                    data-lecturerId="{{videos[videoIndex].lecturerId}}" 
                    catchtap='delLecturerFans'>
                </cover-image>
            </cover-view>

            <!-- 点赞视频 -->
            <cover-view>
                <cover-image class="icon right-icon" 
                    data-likeNum="{{videos[videoIndex].likenum}}"
                    data-index="{{videoIndex}}" 
                    data-videoId="{{videos[videoIndex].contentId}}"
                    wx:if="{{videos[videoIndex].isLike == 0}}" 
                    src='/images/video/start.png'>
                </cover-image>
                <cover-image class="icon right-icon" 
                    wx:else src='/images/video/active.png'>
                </cover-image>
                <cover-view class="text">{{videos[videoIndex].likenum}}</cover-view>
            </cover-view>
            
            <!-- 评论 -->
            <cover-view catchtap='showTalks' 
                data-videoId="{{videos[videoIndex].contentId}}"
                data-commnetnum="{{videos[videoIndex].commnetnum}}">
                <cover-image class="icon right-icon" src='/images/video/content.png'></cover-image>
                <cover-view class="text">{{videos[videoIndex].commnetnum}}</cover-view>
            </cover-view>

        </cover-view>

        <!-- 进度条  -->
        <cover-view class="jindu-back"></cover-view>
        <cover-view class="jindu" style='width: {{percent}}%'></cover-view>

        <!-- 描述  -->
        <cover-view class="desc">
            <cover-view class='desc-content'>
                <cover-image class="icon huati" src='/images/video/huati.png'></cover-image>
                <cover-view class="desc-text" 
                    wx:key="index" 
                    wx:for="{{videos[videoIndex].tagList}}">
                    {{item.tagName}}</cover-view>
            </cover-view>
            <cover-view class='desc-content tag'>
                <cover-view class="desc-text">{{videos[videoIndex].description}}</cover-view>
            </cover-view>
        </cover-view>

    </video>

    <image class="play-btn" wx:if="{{!playState && !animationShow}}" src="/images/video/play.png"></image>
   
</view>
<view class='content' wx:if="{{nodata}}">
    <view class='tab-content-list'>
        <view class='nodata'>
            <image src="/images/video/data.png"></image>
        </view>
        <view class='center'>
            <text>亲,没有获取到数据哦!</text>
        </view>
    </view>
</view>